graph TB
    subgraph "üñ•Ô∏è CENTRAL PLATFORM"
        UI["<b>Central Web UI</b><br/>React Frontend<br/>http://154.114.10.123:3000<br/><br/>User Authentication ‚úÖ<br/>Job Submission ‚úÖ<br/>Service Discovery ‚úÖ<br/>Result Management"]

        Gateway["<b>API Gateway</b><br/>Port 8000<br/><br/>Request Routing<br/>Load Balancing<br/>Authentication"]

        Backend["<b>Backend Services</b><br/><br/>‚Ä¢ User Service (Port 8001)<br/>‚Ä¢ Service Registry (Port 8002)<br/>‚Ä¢ Job Processor (Port 8003)<br/>‚Ä¢ File Manager (Port 8004)<br/>‚Ä¢ Monitoring (Port 8005)"]

        DB[("<b>Central Database</b><br/>PostgreSQL<br/><br/>‚Ä¢ User accounts<br/>‚Ä¢ Job metadata<br/>‚Ä¢ Service catalog<br/>‚Ä¢ Results index")]

        Queue[("<b>Task Queue</b><br/>Redis + Celery<br/><br/>Job orchestration<br/>Async processing")]
    end

    subgraph "‚òÅÔ∏è CLOUD IMPUTATION SERVICES"
        Michigan["<b>üß¨ Michigan Imputation Server</b><br/>https://impute.afrigen-d.org<br/><br/><b>Type:</b> Michigan/TopMed<br/><b>Format:</b> Cloudgene API<br/><b>Status:</b> ‚úÖ Integrated<br/><br/><b>Reference Panels:</b><br/>‚Ä¢ 1000 Genomes Phase 3 (v5)<br/>‚Ä¢ H3Africa (v6) - 4,447 samples<br/>‚Ä¢ HapMap 2<br/>‚Ä¢ CAAPA<br/><br/><b>Features:</b><br/>‚Ä¢ Quality Control<br/>‚Ä¢ Phasing (Eagle2)<br/>‚Ä¢ Imputation (Minimac4)<br/>‚Ä¢ GRCh37/GRCh38 support"]

        H3Africa["<b>üåç H3Africa Imputation Server</b><br/>Legacy Historical Service<br/><br/><b>Type:</b> Custom API<br/><b>Status:</b> Available<br/><br/><b>Reference Panels:</b><br/>‚Ä¢ African populations<br/>‚Ä¢ H3Africa consortium data<br/><br/><b>Features:</b><br/>‚Ä¢ African-specific panels<br/>‚Ä¢ Historical job support"]
    end

    subgraph "üè¢ ON-PREMISE SERVICES"
        Mali["<b>üìç MALI Site</b><br/>West Africa Regional Hub<br/><br/><b>Infrastructure:</b><br/>‚Ä¢ DRS (Data Repository Service)<br/>‚Ä¢ WesKIT (Workflow Execution)<br/>‚Ä¢ Nextflow pipelines<br/>‚Ä¢ Local Docker compute<br/><br/><b>Data:</b><br/>‚Ä¢ Local genomic datasets<br/>‚Ä¢ Regional reference data<br/><br/><b>Status:</b> Planned"]

        ILIFU["<b>üìç ILIFU Site</b><br/>South Africa HPC<br/><br/><b>Infrastructure:</b><br/>‚Ä¢ DRS/WesKIT<br/>‚Ä¢ Attestation services<br/>‚Ä¢ Data SPA integration<br/>‚Ä¢ HPC compute cluster<br/><br/><b>Data:</b><br/>‚Ä¢ Secure data hosting<br/>‚Ä¢ Privacy-preserving compute<br/><br/><b>Status:</b> Planned"]

        Azure["<b>‚òÅÔ∏è Azure Site</b><br/>Cloud Compute<br/><br/><b>Infrastructure:</b><br/>‚Ä¢ DNAstack platform<br/>‚Ä¢ DRS/WesKIT<br/>‚Ä¢ Docker containers<br/>‚Ä¢ Scalable compute<br/><br/><b>Features:</b><br/>‚Ä¢ Cloud-native workflows<br/>‚Ä¢ Auto-scaling<br/><br/><b>Status:</b> Planned"]
    end

    subgraph "üë• USER INTERACTION"
        Researcher["<b>üë®‚Äçüî¨ Researcher</b><br/><br/>‚Ä¢ Upload VCF files<br/>‚Ä¢ Select imputation service<br/>‚Ä¢ Choose reference panel<br/>‚Ä¢ Configure parameters<br/>‚Ä¢ Monitor job progress<br/>‚Ä¢ Download results"]
    end

    %% User to Central UI
    Researcher -->|"1. Access Web Interface"| UI

    %% Central UI internal flow
    UI -->|"2. Authenticate & Route"| Gateway
    Gateway -->|"3. Process Requests"| Backend
    Backend -->|"4. Store Metadata"| DB
    Backend -->|"5. Queue Jobs"| Queue

    %% Central to Imputation Services
    Queue -->|"6. Submit Job<br/>(Cloudgene Format)<br/>refpanel: apps@h3africa-v6hc-s@1.0.0"| Michigan
    Queue -->|"Submit Job<br/>(Custom API)"| H3Africa

    %% Future connections (dashed)
    Queue -.->|"Future: WesKIT Protocol"| Mali
    Queue -.->|"Future: WesKIT Protocol"| ILIFU
    Queue -.->|"Future: DNAstack API"| Azure

    %% Results flow back
    Michigan -->|"7. Job Status Updates<br/>8. Results Available"| Queue
    H3Africa -->|"Job Status & Results"| Queue
    Mali -.->|"Future: Results"| Queue
    ILIFU -.->|"Future: Results"| Queue
    Azure -.->|"Future: Results"| Queue

    Queue -->|"9. Update Job Status"| Backend
    Backend -->|"10. Store Results Metadata"| DB
    UI -->|"11. Notify User"| Researcher

    %% Data residency consideration
    Mali -.->|"Data Residency<br/>Considerations"| ILIFU

    %% Monitoring
    Backend -->|"Health Checks"| Michigan
    Backend -->|"Health Checks"| H3Africa
    Backend -.->|"Future: Health Checks"| Mali
    Backend -.->|"Future: Health Checks"| ILIFU
    Backend -.->|"Future: Health Checks"| Azure

    %% Styling
    style UI fill:#FFD700,stroke:#000,stroke-width:4px,color:#000
    style Gateway fill:#FFA500,stroke:#000,stroke-width:3px,color:#000
    style Backend fill:#FFE4B5,stroke:#000,stroke-width:2px,color:#000
    style DB fill:#4169E1,stroke:#000,stroke-width:2px,color:#fff
    style Queue fill:#DC143C,stroke:#000,stroke-width:2px,color:#fff

    style Michigan fill:#32CD32,stroke:#000,stroke-width:3px,color:#000
    style H3Africa fill:#3CB371,stroke:#000,stroke-width:3px,color:#000

    style Mali fill:#87CEEB,stroke:#000,stroke-width:2px,color:#000,stroke-dasharray: 5 5
    style ILIFU fill:#87CEEB,stroke:#000,stroke-width:2px,color:#000,stroke-dasharray: 5 5
    style Azure fill:#87CEEB,stroke:#000,stroke-width:2px,color:#000,stroke-dasharray: 5 5

    style Researcher fill:#FFB6C1,stroke:#000,stroke-width:2px,color:#000
